{% extends 'marketing/base.html' %}
{% load static %}

{% block title %}MIS Sheets - Marketing Hub{% endblock %}

{% block content %}
<div class="mx-auto w-full p-4">
    <!-- Modern Header -->
    <div class="mb-4 sm:mb-6">
        <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
            <div>
                <h1 class="text-xl sm:text-2xl font-bold text-gray-900">MIS Sheets</h1>
                <p class="text-sm sm:text-base text-gray-600">Complete tabbed interface for all MIS sheets with forms</p>
            </div>
            <a href="{% url 'marketing:mis_dashboard' %}" class="inline-flex items-center gap-2 px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-xs sm:text-sm transition">
                <i data-lucide="arrow-left" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                Back to Dashboard
            </a>
        </div>
    </div>

    <!-- Tabbed Navigation -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-4 sm:mb-6">
        <div class="border-b border-gray-200">
            <nav class="-mb-px flex flex-wrap space-x-2 sm:space-x-4 px-3 sm:px-6 overflow-x-hidden" aria-label="Tabs">
                <button type="button" onclick="switchTab('how-to-use')" 
                        id="tab-how-to-use"
                        class="tab-button active flex items-center gap-1 sm:gap-2 py-2 sm:py-3 px-2 sm:px-3 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap flex-shrink-0">
                    <i data-lucide="help-circle" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    How to Use
                </button>
                <button type="button" onclick="switchTab('inquiry-log')" 
                        id="tab-inquiry-log"
                        class="tab-button flex items-center gap-1 sm:gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap">
                    <i data-lucide="clipboard-list" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    Inquiry Log
                </button>
                <button type="button" onclick="switchTab('follow-up-status')" 
                        id="tab-follow-up-status"
                        class="tab-button flex items-center gap-1 sm:gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap">
                    <i data-lucide="check-circle" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    Follow-Up Status
                </button>
                <button type="button" onclick="switchTab('project-today')" 
                        id="tab-project-today"
                        class="tab-button flex items-center gap-1 sm:gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap">
                    <i data-lucide="briefcase" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    Project Today
                </button>
                <button type="button" onclick="switchTab('order-expected')" 
                        id="tab-order-expected"
                        class="tab-button flex items-center gap-1 sm:gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap">
                    <i data-lucide="calendar" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    Order Expected
                </button>
                <button type="button" onclick="switchTab('purchase-order')" 
                        id="tab-purchase-order"
                        class="tab-button flex items-center gap-1 sm:gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap">
                    <i data-lucide="shopping-cart" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    Purchase Order
                </button>
                <button type="button" onclick="switchTab('new-data')" 
                        id="tab-new-data"
                        class="tab-button flex items-center gap-1 sm:gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap">
                    <i data-lucide="trending-up" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    New Data
                </button>
                <button type="button" onclick="switchTab('od-plan')" 
                        id="tab-od-plan"
                        class="tab-button flex items-center gap-1 sm:gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap">
                    <i data-lucide="map-pin" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    OD Plan
                </button>
                <button type="button" onclick="switchTab('legends')" 
                        id="tab-legends"
                        class="tab-button flex items-center gap-1 sm:gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap">
                    <i data-lucide="book-open" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    Legends
                </button>
            </nav>
        </div>

        <!-- Tab Content -->
        <div class="p-3 sm:p-6">
            <!-- How to Use Tab -->
            <div id="content-how-to-use" class="tab-content">
                <div class="space-y-4 sm:space-y-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 sm:p-6">
                        <h3 class="text-base sm:text-lg font-semibold text-blue-900 mb-3 sm:mb-4 flex items-center gap-2">
                            <i data-lucide="info" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                            MIS System Overview
                        </h3>
                        <p class="text-sm sm:text-base text-blue-800 mb-3 sm:mb-4">
                            This Management Information System (MIS) provides comprehensive tracking and management of all business activities. 
                            Created by <strong>Nikhil Badhe</strong>, it includes multiple sheets for different business processes.
                        </p>
                        
                        <h4 class="text-sm sm:text-base font-semibold text-blue-900 mb-2 sm:mb-3">Worksheet Directory:</h4>
                        <ul class="space-y-2 text-sm sm:text-base text-blue-800">
                            <li class="flex items-center gap-2">
                                <i data-lucide="check-circle" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <strong>Follow-Up Status:</strong> Used for Data Validation Entries, No need to take action
                            </li>
                            <li class="flex items-center gap-2">
                                <i data-lucide="briefcase" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <strong>Project Today:</strong> [Template sheet]
                            </li>
                            <li class="flex items-center gap-2">
                                <i data-lucide="calendar" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <strong>Order expected in Next Month:</strong> [Template sheet]
                            </li>
                            <li class="flex items-center gap-2">
                                <i data-lucide="shopping-cart" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <strong>Purchase Order Status:</strong> [Template sheet]
                            </li>
                            <li class="flex items-center gap-2">
                                <i data-lucide="book-open" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <strong>Legends:</strong> [Reference sheet]
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Inquiry Log Tab -->
            <div id="content-inquiry-log" class="tab-content hidden">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-2 mb-4 sm:mb-6">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900">Inquiry Log Management</h3>
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                        <button onclick="addNewForm('inquiry-log')" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-xs sm:text-sm transition">
                            <i data-lucide="plus" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            Add New
                        </button>
                        <a href="{% url 'marketing:inquiry_log_list' %}" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-xs sm:text-sm transition">
                            <i data-lucide="list" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            View All Entries
                        </a>
                    </div>
                </div>
                <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4">Manage your business inquiries and track quote status.</p>
                
                <!-- Forms Container -->
                <div id="inquiry-log-forms-container">
                    <!-- Include Inquiry Log Form -->
                    {% include 'marketing/inquiry_log_tab_form.html' %}
                </div>
            </div>

            <!-- Follow-Up Status Tab -->
            <div id="content-follow-up-status" class="tab-content hidden">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-2 mb-4 sm:mb-6">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900">Follow-Up Status Management</h3>
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                        <button onclick="addNewForm('follow-up-status')" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-xs sm:text-sm transition">
                            <i data-lucide="plus" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            Add New
                        </button>
                        <a href="{% url 'marketing:follow_up_status_list' %}" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-xs sm:text-sm transition">
                            <i data-lucide="list" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            View All Entries
                        </a>
                    </div>
                </div>
                <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4">Track enquiry follow-up activities and status updates.</p>
                
                <!-- Forms Container -->
                <div id="follow-up-status-forms-container">
                    <!-- Include Follow-Up Status Form -->
                    {% include 'marketing/follow_up_status_tab_form.html' %}
                </div>
            </div>

            <!-- Project Today Tab -->
            <div id="content-project-today" class="tab-content hidden">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-2 mb-4 sm:mb-6">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900">Project Today Management</h3>
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                        <button onclick="addNewForm('project-today')" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-xs sm:text-sm transition">
                            <i data-lucide="plus" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            Add New
                        </button>
                    </div>
                </div>
                <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4">Current active project tracking and management.</p>
                
                <!-- Forms Container -->
                <div id="project-today-forms-container">
                    <!-- Include Project Today Form -->
                    {% include 'marketing/project_today_tab_form.html' %}
                </div>
            </div>

            <!-- Order Expected Tab -->
            <div id="content-order-expected" class="tab-content hidden">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-2 mb-4 sm:mb-6">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900">Order Expected Next Month</h3>
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                        <button onclick="addNewForm('order-expected')" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-xs sm:text-sm transition">
                            <i data-lucide="plus" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            Add New
                        </button>
                    </div>
                </div>
                <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4">Sales forecast tracking for upcoming months.</p>
                
                <!-- Forms Container -->
                <div id="order-expected-forms-container">
                    <!-- Include Order Expected Form -->
                    {% include 'marketing/order_expected_tab_form.html' %}
                </div>
            </div>

            <!-- Purchase Order Tab -->
            <div id="content-purchase-order" class="tab-content hidden">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-2 mb-4 sm:mb-6">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900">Purchase Order Management</h3>
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                        <button onclick="addNewForm('purchase-order')" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-xs sm:text-sm transition">
                            <i data-lucide="plus" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            Add New
                        </button>
                    </div>
                </div>
                <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4">Purchase order management and tracking.</p>
                
                <!-- Forms Container -->
                <div id="purchase-order-forms-container">
                    <!-- Include Purchase Order Form -->
                    {% include 'marketing/purchase_order_tab_form.html' %}
                </div>
            </div>

            <!-- New Data Tab -->
            <div id="content-new-data" class="tab-content hidden">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-2 mb-4 sm:mb-6">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900">New Data Management</h3>
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                        <button onclick="addNewForm('new-data')" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-xs sm:text-sm transition">
                            <i data-lucide="plus" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            Add New
                        </button>
                    </div>
                </div>
                <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4">New customer acquisition tracking and monthly breakdown.</p>
                
                <!-- Forms Container -->
                <div id="new-data-forms-container">
                    <!-- Include New Data Form -->
                    {% include 'marketing/new_data_tab_form.html' %}
                </div>
            </div>

            <!-- OD Plan Tab -->
            <div id="content-od-plan" class="tab-content hidden">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-2 mb-4 sm:mb-6">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900">OD Plan Management</h3>
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                        <button onclick="addNewForm('od-plan')" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-xs sm:text-sm transition">
                            <i data-lucide="plus" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            Add New
                        </button>
                    </div>
                </div>
                <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4">Outdoor Planning (Field visit planning) and management.</p>
                
                <!-- Forms Container -->
                <div id="od-plan-forms-container">
                    <!-- Include OD Plan Form -->
                    {% include 'marketing/od_plan_tab_form.html' %}
                </div>
            </div>

            <!-- Legends Tab -->
            <div id="content-legends" class="tab-content hidden">
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-4 sm:mb-6">Legends - Master Reference Data</h3>
                
                <!-- Follow-Up Status Categories -->
                <div class="mb-6 sm:mb-8">
                    <h4 class="text-sm sm:text-base font-semibold text-gray-800 mb-3 sm:mb-4 flex items-center gap-2">
                        <i data-lucide="check-circle" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                        Follow-Up Status Categories
                    </h4>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="file-text" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">QTN Submitted</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="refresh-cw" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">QTN Followup</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="users" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">Technical Discussions</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="monitor" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">At Customer Desk</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="check-circle" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">Order Finalization (AP)</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="shopping-cart" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">PO Release (AP)</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="check" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">PO Acknowledge (AP)</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="clipboard" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">WO Prepared</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="pause" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">On-Hold (Customer end)</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="x-circle" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-blue-800">Requirement Cancelled (Customer end)</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="x" class="w-3 h-3 sm:w-4 sm:h-4 text-red-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-red-800">1 - Order Loss</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="x" class="w-3 h-3 sm:w-4 sm:h-4 text-red-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-red-800">2 - Order Loss</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="x" class="w-3 h-3 sm:w-4 sm:h-4 text-red-600"></i>
                                <span class="text-xs sm:text-sm font-medium text-red-800">3 - Order Loss</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Project Today Categories -->
                <div class="mb-6 sm:mb-8">
                    <h4 class="text-sm sm:text-base font-semibold text-gray-800 mb-3 sm:mb-4 flex items-center gap-2">
                        <i data-lucide="briefcase" class="w-3 h-3 sm:w-4 sm:h-4 text-green-600"></i>
                        Project Today Categories
                    </h4>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8">
                        <!-- Pharmaceutical Industries -->
                        <div>
                            <h5 class="text-sm sm:text-base font-semibold text-green-800 mb-2 sm:mb-3">Pharmaceutical Industries:</h5>
                            <div class="space-y-2">
                                <div class="bg-green-50 border border-green-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-green-800">API</span>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-green-800">Injectable</span>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-green-800">Formulation</span>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-green-800">Oncology</span>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-green-800">Intermediate</span>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-green-800">Packaging</span>
                                </div>
                            </div>
                        </div>

                        <!-- Non-Pharmaceutical Industries -->
                        <div>
                            <h5 class="text-sm sm:text-base font-semibold text-purple-800 mb-2 sm:mb-3">Non-Pharmaceutical Industries:</h5>
                            <div class="space-y-2">
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">FMCG</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Chemical Industry</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Blood bank</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Oil & Gas Industry</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Cosmetics</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Textile</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Hospital</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Government</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Agri</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Dairy</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Veterinary</span>
                                </div>
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-2 sm:p-3">
                                    <span class="text-xs sm:text-sm font-medium text-purple-800">Other</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.tab-button {
    border-color: transparent;
    color: #6b7280;
}

.tab-button.active {
    border-color: #3b82f6;
    color: #1f2937;
}

.tab-button:hover {
    color: #374151;
    border-color: #d1d5db;
}

.tab-content {
    display: block;
}

.tab-content.hidden {
    display: none;
}
</style>

<script>
function switchTab(tabName) {
    // Hide all tab contents
    const contents = document.querySelectorAll('.tab-content');
    contents.forEach(content => content.classList.add('hidden'));
    
    // Remove active class from all tabs
    const tabs = document.querySelectorAll('.tab-button');
    tabs.forEach(tab => tab.classList.remove('active'));
    
    // Show selected tab content
    document.getElementById('content-' + tabName).classList.remove('hidden');
    
    // Add active class to selected tab
    document.getElementById('tab-' + tabName).classList.add('active');
}

function addNewForm(formType) {
    const container = document.getElementById(formType + '-forms-container');
    if (!container) return;
    
    // Find the first form in the container to clone
    const firstForm = container.querySelector('.bg-white.rounded-lg.border.border-gray-200.shadow-sm');
    if (!firstForm) return;
    
    // Clone the first form
    const newForm = firstForm.cloneNode(true);
    
    // Remove any existing header if it exists
    const existingHeader = newForm.querySelector('.p-4.border-b.border-gray-200.bg-gray-50');
    if (existingHeader) {
        existingHeader.remove();
    }
    
    // Add a subtle separator and remove button at the top
    const separator = document.createElement('div');
    separator.className = 'flex items-center justify-between mb-3 sm:mb-4 p-2 sm:p-3 bg-gray-50 rounded-lg border border-gray-200';
    separator.innerHTML = `
        <div class="flex items-center gap-2">
            <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
            <span class="text-xs sm:text-sm font-medium text-gray-700">Additional Entry</span>
        </div>
        <button onclick="removeForm(this)" class="inline-flex items-center gap-1 px-2 sm:px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 text-xs sm:text-sm transition">
            <i data-lucide="trash-2" class="w-3 h-3 sm:w-4 sm:h-4"></i>
            Remove
        </button>
    `;
    
    // Insert the separator at the beginning of the form
    newForm.insertBefore(separator, newForm.firstChild);
    
    // Clear all form inputs in the new form
    const inputs = newForm.querySelectorAll('input, textarea, select');
    inputs.forEach(input => {
        if (input.type === 'checkbox' || input.type === 'radio') {
            input.checked = false;
        } else {
            input.value = '';
        }
    });
    
    // Add the new form to the container
    container.appendChild(newForm);
    
    // Recreate icons for the new elements
    lucide.createIcons();
    
    // Scroll to the new form
    newForm.scrollIntoView({ behavior: 'smooth', block: 'center' });
}

function removeForm(button) {
    const formElement = button.closest('.bg-white.rounded-lg.border.border-gray-200.shadow-sm');
    if (formElement) {
        formElement.remove();
    }
}


// Draft and Save functionality
function saveAsDraft(formElement) {
    const formData = new FormData(formElement);
    const formType = getCurrentTabType();
    
    // Here you would normally send the data to the backend
    console.log('Saving as draft:', formType, formData);
    
    // Show success message
    showNotification('Draft saved successfully!', 'success');
    
    // Update form state to show it's saved as draft
    markFormAsDraft(formElement);
}

function saveForm(formElement) {
    // Check if all required fields are filled
    const requiredFields = formElement.querySelectorAll('[required]');
    const emptyFields = [];
    
    requiredFields.forEach(field => {
        if (!field.value.trim()) {
            emptyFields.push(field.getAttribute('name') || field.getAttribute('id') || 'Unknown field');
        }
    });
    
    if (emptyFields.length > 0) {
        showIncompleteFormModal(emptyFields, formElement);
        return false;
    }
    
    // All fields are filled, proceed with save
    const formData = new FormData(formElement);
    const formType = getCurrentTabType();
    
    // Here you would normally send the data to the backend
    console.log('Saving form:', formType, formData);
    
    showNotification('Form saved successfully!', 'success');
    return true;
}

function getCurrentTabType() {
    const activeTab = document.querySelector('.tab-button.active');
    return activeTab ? activeTab.id.replace('tab-', '') : 'unknown';
}

function markFormAsDraft(formElement) {
    // Add a visual indicator that this form is saved as draft
    let draftIndicator = formElement.querySelector('.draft-indicator');
    if (!draftIndicator) {
        draftIndicator = document.createElement('div');
        draftIndicator.className = 'draft-indicator flex items-center gap-2 p-2 bg-yellow-50 border border-yellow-200 rounded-lg mb-4';
        draftIndicator.innerHTML = `
            <i data-lucide="edit" class="w-4 h-4 text-yellow-600"></i>
            <span class="text-sm font-medium text-yellow-800">This form is saved as draft</span>
        `;
        formElement.insertBefore(draftIndicator, formElement.firstChild);
        lucide.createIcons();
    }
}

function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transition-all duration-300 ${
        type === 'success' ? 'bg-green-100 border border-green-200 text-green-800' :
        type === 'error' ? 'bg-red-100 border border-red-200 text-red-800' :
        'bg-blue-100 border border-blue-200 text-blue-800'
    }`;
    notification.innerHTML = `
        <div class="flex items-center gap-2">
            <i data-lucide="${type === 'success' ? 'check-circle' : type === 'error' ? 'alert-circle' : 'info'}" class="w-4 h-4"></i>
            <span class="font-medium">${message}</span>
        </div>
    `;
    
    document.body.appendChild(notification);
    lucide.createIcons();
    
    // Auto remove after 3 seconds
    setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}

function showIncompleteFormModal(emptyFields, formElement) {
    const modal = document.createElement('div');
    modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50';
    modal.innerHTML = `
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6">
            <div class="flex items-center gap-3 mb-4">
                <div class="p-2 bg-yellow-100 rounded-lg">
                    <i data-lucide="alert-triangle" class="w-5 h-5 text-yellow-600"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900">Incomplete Form</h3>
            </div>
            
            <p class="text-gray-600 mb-4">
                Some required fields are not filled. You can either:
            </p>
            
            <div class="space-y-3 mb-6">
                <div class="p-3 bg-gray-50 rounded-lg">
                    <p class="text-sm font-medium text-gray-700 mb-2">Missing fields:</p>
                    <ul class="text-sm text-gray-600 space-y-1">
                        ${emptyFields.map(field => `<li>â€¢ ${field}</li>`).join('')}
                    </ul>
                </div>
            </div>
            
            <div class="flex flex-col sm:flex-row gap-3">
                <button onclick="closeModal(this)" class="flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
                    Continue Editing
                </button>
                <button onclick="saveAsDraftFromModal(this)" class="flex-1 px-4 py-2 text-sm font-medium text-white bg-yellow-600 rounded-lg hover:bg-yellow-700 transition-colors">
                    Save as Draft
                </button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    lucide.createIcons();
    
    // Store form reference for draft save
    modal.formElement = formElement;
}

function closeModal(button) {
    const modal = button.closest('.fixed.inset-0');
    if (modal) {
        modal.remove();
    }
}

function saveAsDraftFromModal(button) {
    const modal = button.closest('.fixed.inset-0');
    if (modal && modal.formElement) {
        saveAsDraft(modal.formElement);
        modal.remove();
    }
}

document.addEventListener('DOMContentLoaded', function() {
    // Create Lucide icons
    lucide.createIcons();
    
    // Add event listeners to all forms
    document.addEventListener('submit', function(e) {
        const form = e.target.closest('form');
        if (form && form.closest('.tab-content')) {
            e.preventDefault();
            saveForm(form);
        }
    });
});
</script>
{% endblock %}
