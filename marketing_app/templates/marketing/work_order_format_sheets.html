{% extends 'marketing/base.html' %}
{% load static %}

{% block title %}Work Order Sheets - Marketing Hub{% endblock %}

{% block content %}
<div class="mx-auto w-full p-2 md:p-4 xl:p-2">
    <!-- Modern Header -->
    <div class="mb-4 sm:mb-6">
        <div class="flex flex-col gap-3 sm:gap-2 sm:flex-row sm:items-center sm:justify-between">
            <div>
                <h1 class="text-xl sm:text-2xl font-bold text-gray-900">Work Order Sheets</h1>
                <p class="text-sm sm:text-base text-gray-600">Complete tabbed interface for Work Order Format template with comprehensive equipment manufacturing specifications</p>
            </div>
            <a href="{% url 'marketing:work_order_format_dashboard' %}" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs sm:text-sm transition">
                <i data-lucide="arrow-left" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                Back to Dashboard
            </a>
        </div>
    </div>

    <!-- Tabbed Navigation -->
    <div class="rounded-lg border border-gray-200 bg-white shadow-sm mb-4 sm:mb-6">
        <div class="border-b border-gray-200">
            <nav class="-mb-px flex space-x-4 sm:space-x-8 px-3 sm:px-6 overflow-x-auto" aria-label="Tabs">
                <button type="button" onclick="switchTab('work-order-template')" 
                        id="tab-work-order-template"
                        class="tab-button active flex items-center gap-1 sm:gap-2 py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap">
                    <i data-lucide="file-text" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                    Work Order Template
                </button>
            </nav>
        </div>

        <!-- Tab Content -->
        <div class="p-4 sm:p-6">
            <!-- Work Order Template Tab -->
            <div id="content-work-order-template" class="tab-content">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-2 mb-4 sm:mb-6">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900">Work Order Format Template for Equipment Manufacturing</h3>
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                        <button onclick="addNewForm('work-order-template')" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs sm:text-sm transition">
                            <i data-lucide="plus" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            Add New
                        </button>
                        <a href="{% url 'marketing:work_order_format_list' %}" class="inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs sm:text-sm transition">
                            <i data-lucide="list" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                            View All Entries
                        </a>
                    </div>
                </div>
                <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4">Comprehensive Work Order template with Header Information, Technical Specifications, Control Systems, Accessories, Standby Systems, Tray & Rack Specifications, Documentation, Special Instructions, and Payment Terms.</p>
                
                <!-- Forms Container -->
                <div id="work-order-template-forms-container">
                    <!-- Include Work Order Form -->
                    {% include 'marketing/work_order_format_tab_form.html' %}
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Create Lucide icons
    lucide.createIcons();
    
    // Tab switching functionality
    window.switchTab = function(tabName) {
        // Hide all tab contents
        const allContents = document.querySelectorAll('.tab-content');
        allContents.forEach(content => {
            content.classList.add('hidden');
        });
        
        // Remove active class from all tab buttons
        const allTabs = document.querySelectorAll('.tab-button');
        allTabs.forEach(tab => {
            tab.classList.remove('active', 'border-blue-500', 'text-blue-600');
            tab.classList.add('border-transparent', 'text-gray-500');
        });
        
        // Show selected tab content
        const selectedContent = document.getElementById('content-' + tabName);
        if (selectedContent) {
            selectedContent.classList.remove('hidden');
        }
        
        // Add active class to selected tab button
        const selectedTab = document.getElementById('tab-' + tabName);
        if (selectedTab) {
            selectedTab.classList.add('active', 'border-blue-500', 'text-blue-600');
            selectedTab.classList.remove('border-transparent', 'text-gray-500');
        }
    };
    
    // Add new form functionality
    window.addNewForm = function(tabName) {
        const container = document.getElementById(tabName + '-forms-container');
        if (container) {
            // Find the first form in the container
            const firstForm = container.querySelector('.bg-white.rounded-lg.border');
            if (firstForm) {
                // Clone the first form
                const newForm = firstForm.cloneNode(true);
                
                // Clear all input values in the cloned form
                const inputs = newForm.querySelectorAll('input, select, textarea');
                inputs.forEach(input => {
                    if (input.type === 'checkbox' || input.type === 'radio') {
                        input.checked = false;
                    } else {
                        input.value = '';
                    }
                });
                
                // Add a subtle header to indicate this is an additional entry
                const additionalHeader = document.createElement('div');
                additionalHeader.className = 'mb-3 sm:mb-4 p-2 sm:p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between';
                additionalHeader.innerHTML = `
                    <div class="flex items-center gap-1 sm:gap-2">
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                        <span class="text-xs sm:text-sm font-medium text-blue-900">Additional Entry</span>
                    </div>
                    <button onclick="this.closest('.bg-white').remove()" class="text-red-600 hover:text-red-800 text-xs sm:text-sm">
                        <i data-lucide="x" class="w-3 h-3 sm:w-4 sm:h-4"></i>
                        Remove
                    </button>
                `;
                
                // Insert the header before the form
                newForm.insertBefore(additionalHeader, newForm.firstChild);
                
                // Add the new form to the container
                container.appendChild(newForm);
                
                // Re-initialize Lucide icons for the new form
                lucide.createIcons();
            }
        }
    };
});
</script>
{% endblock %}
